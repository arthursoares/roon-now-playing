# Quick Reference: Roon Screen Cover

## Common Imports

### Shared Types
```typescript
import type { Zone, Track, NowPlaying, PlaybackState, LayoutType, FontType } from '@roon-screen-cover/shared';
import type { ClientMessage, ServerMessage } from '@roon-screen-cover/shared';
import { LAYOUTS, FONTS, FONT_CONFIG } from '@roon-screen-cover/shared';
```

### Client Composables
```typescript
import { useWebSocket } from './composables/useWebSocket';
import { useNowPlaying } from './composables/useNowPlaying';
import { usePreferences } from './composables/usePreferences';
import { useColorExtraction } from './composables/useColorExtraction';
import { useFontLoader } from './composables/useFontLoader';
import { useFacts } from './composables/useFacts';
```

## Layout Component Props

All layout components receive these props:
```typescript
interface LayoutProps {
  track: Track | null;
  state: PlaybackState;
  isPlaying: boolean;
  progress: number;
  currentTime: string;
  duration: string;
  artworkUrl: string | null;
  zoneName: string;
}
```

## Facts Composable Usage

```typescript
const trackRef = computed(() => props.track);
const stateRef = computed(() => props.state);
const { facts, currentFactIndex, currentFact, isLoading, error, cached } = useFacts(trackRef, stateRef);

// facts.value: string[] - array of facts about the track
// currentFact.value: string | null - currently displayed fact
// currentFactIndex.value: number - index of current fact
// isLoading.value: boolean - loading state
// error.value: FactsError | null - error if any
// cached.value: boolean - whether facts came from cache
```

### Facts Layout Structure
All facts layouts follow a fixed structure to prevent layout shifts:
1. **Facts Area** - Primary content, larger fonts, vertically centered
2. **Metadata** - Always visible below facts (title, artist, album)
3. **Bottom Section** - Fixed position (progress bar, zone indicator)

## Color Extraction Usage

```typescript
const artworkUrlRef = computed(() => props.artworkUrl);
const { colors, isTransitioning } = useColorExtraction(artworkUrlRef);

// colors.value contains:
// - background: string (CSS hsl)
// - backgroundEdge: string
// - shadow: string
// - text: string
// - textSecondary: string
// - textTertiary: string
// - mode: 'light' | 'dark'
// - ready: boolean
```

## File Locations

| What | Where |
|------|-------|
| Shared types | `packages/shared/src/index.ts` |
| Server entry | `packages/server/src/index.ts` |
| Roon client | `packages/server/src/roon.ts` |
| WebSocket handler | `packages/server/src/websocket.ts` |
| Vue app entry | `packages/client/src/App.vue` |
| Layout components | `packages/client/src/layouts/` |
| Composables | `packages/client/src/composables/` |

## Test Commands

```bash
# Run all tests
pnpm test

# Watch mode
pnpm test:watch

# Type check
pnpm typecheck

# Build
pnpm build
```

## Development URLs

- Client (dev): http://localhost:5173
- Server: http://localhost:3000
- With layout: http://localhost:5173/?layout=ambient
- With zone: http://localhost:5173/?zone=Office&layout=ambient
- With font: http://localhost:5173/?font=comfortaa
- All params: http://localhost:5173/?zone=Office&layout=ambient&font=patua-one

## Available Fonts

| URL Param | Font Name |
|-----------|-----------|
| `system` | System default |
| `patua-one` | Patua One |
| `comfortaa` | Comfortaa |
| `noto-sans-display` | Noto Sans Display |
| `coda` | Coda |
| `bellota-text` | Bellota Text |
| `big-shoulders` | Big Shoulders Display |
