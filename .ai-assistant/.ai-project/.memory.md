# Project Memory

> This file preserves project context across AI assistant sessions.
> Update this file as the project evolves.

## Project Overview

**Name:** `roon-now-playing`
**Type:** Web application (Roon Now Playing display)
**Purpose:** Display now playing information from Roon music server on various devices/screens

### Technology Stack

- **Framework:** Vue 3 (client), Express (server)
- **Language:** TypeScript 5.x
- **Build System:** Vite (client), tsc (server/shared)
- **Package Manager:** pnpm (monorepo with workspaces)
- **Testing:** None configured
- **Node Version:** 23.x

## Project Structure

```
roon-now-playing/
├── packages/
│   ├── client/                # Vue 3 frontend application
│   │   ├── src/
│   │   │   ├── components/    # UI components (NowPlaying, ZonePicker, ProgressBar)
│   │   │   ├── composables/   # Vue composables (useWebSocket, usePreferences, useColorExtraction, useBackgroundStyle)
│   │   │   ├── layouts/       # Display layouts (Detailed, Minimal, Fullscreen, Ambient, Cover)
│   │   │   └── views/         # Page views (NowPlayingView, AdminView)
│   │   └── dist/              # Built client files
│   ├── server/                # Express + WebSocket backend
│   │   └── src/
│   │       ├── index.ts       # Main server entry
│   │       ├── websocket.ts   # WebSocket manager
│   │       ├── admin.ts       # Admin API routes
│   │       └── roon.ts        # Roon API client
│   └── shared/                # Shared types and constants
│       └── src/index.ts       # All shared exports
├── .ai-assistant/             # AI instruction files
└── docker/                    # Docker configuration
```

## Key Features

### Layouts
- **Detailed**: Album art + full track info + progress bar
- **Minimal**: Full-screen artwork with overlay text
- **Fullscreen**: Just the album artwork
- **Ambient**: Color-extracted background with artwork and info
- **Cover**: Clean album art with crossfade transitions

### Configurable Options (URL params + Admin UI + localStorage)
- `layout`: detailed, minimal, fullscreen, ambient, cover
- `font`: system, patua-one, comfortaa, noto-sans-display, coda, bellota-text, big-shoulders
- `background`: black, white, dominant, gradient-radial, gradient-linear
- `zone`: Zone ID or name to auto-select

### Admin Panel
- Available at `/admin`
- Lists connected clients
- Push settings to clients remotely (layout, font, background, zone)
- Set friendly names for clients

## Architecture Decisions

| Decision | Date | Reasoning |
|----------|------|-----------|
| Monorepo with pnpm workspaces | Initial | Share types between client/server |
| Vue 3 Composition API | Initial | Better TypeScript support, composables pattern |
| Color extraction from artwork | 2025-01 | Dynamic theming for Ambient layout |
| Configurable backgrounds | 2025-01 | Allow per-layout background customization |

## Domain Guidelines

| Domain | Key Topics |
|--------|------------|
| TypeScript | Strict types, shared package exports |
| Vue 3 | Composition API, composables, single-file components |
| WebSocket | Real-time updates, client metadata sync |

## Git Workflow

### Branch Naming

- **Main Branch:** `main`
- **Feature Branches:** `feature/description`

### Commit Message Format

```
Brief description of change
```

**Examples from history:**
- `Bump version to 1.0.1`
- `Fix zone discovery to push updates when endpoints change`
- `Update all dependencies to latest versions`
- `Add CI/CD pipeline for Docker image publishing`

## Known Issues & Limitations

| Issue | Impact | Workaround |
|-------|--------|------------|
| No ESLint configured | Linting not available | Manual code review |
| No test suite | No automated testing | Manual testing |

## Session Context

### Recent Work Areas
- Implemented configurable backgrounds for all layouts
- Added BackgroundType to shared types
- Created useBackgroundStyle composable
- Updated all 5 layout components to support dynamic backgrounds
- Added background selection to Admin UI

### Ongoing Work
- Background feature complete and ready to commit

---

**Last Updated:** 2025-01-27
